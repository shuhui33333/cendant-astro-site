---
import "../styles/global.css";

type NavItem = { href: string; label: string };

const props = Astro.props as {
  title?: string;
  description?: string;
  showFooter?: boolean;
  hasHero?: boolean;
  nav?: NavItem[];
};

const title = props.title ?? "页面";
const description =
  props.description ??
  "墨尔本·胜腾国际 - 房产投资 / 项目开发 / 租赁管理 / 移民服务";

const showFooter = props.showFooter ?? true;
const hasHero = props.hasHero ?? false;

const nav: NavItem[] =
  props.nav ??
  [
    { href: "/", label: "首页" },
    { href: "/real-estate", label: "房产资讯" },
    { href: "/property-service", label: "房产服务" },
    { href: "/loan", label: "贷款服务" },
    { href: "/immigration", label: "移民服务" },
    { href: "/company-profile", label: "公司概况" },
    { href: "/contact", label: "联系我们" },
  ];

const pathname = Astro.url?.pathname ?? "/";
const isActive = (href: string) =>
  href === "/" ? pathname === "/" : pathname.startsWith(href);
---

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{title} | Cendant</title>
  <meta name="description" content={description} />

  <!-- template css -->
  <link rel="stylesheet" href="/template15/css/bootstrap.css" />
  <link rel="stylesheet" href="/template15/css/font-awesome.min.css" />
  <link rel="stylesheet" href="/template15/css/style.css" />
  <link rel="stylesheet" href="/template15/css/mainStyles.css" />

  <style is:global>
    /* =========================================================
       基础
    ========================================================= */
    html, body { margin:0; padding:0; }

    /* =========================================================
       NAVBAR 高度真实占位（关键：解决子页被吃掉）
    ========================================================= */
    body.tpl-body:not(.tpl-has-hero) {
      padding-top: 96px; /* 足够覆盖大 logo + 两行文字 */
    }

    body.tpl-has-hero {
      padding-top: 0;
    }

    /* =========================================================
       NAVBAR 基础
    ========================================================= */
    .banner#home {
      position: relative;
      z-index: 9999;
    }

    .banner#home .navbar {
      margin: 0;
      border: none;
      padding: 10px 0;
      background: transparent;
    }

    body:not(.tpl-has-hero) .banner#home .navbar {
      background: #fff;
      box-shadow: 0 6px 18px rgba(0,0,0,.08);
    }

    /* =========================================================
       LOGO + BRAND（核心修复区）
    ========================================================= */

    /* 清掉模板带来的所有多余框 */
    .navbar-brand,
    .navbar-brand * {
      border: none !important;
      outline: none !important;
      box-shadow: none !important;
      background: transparent !important;
    }

    .navbar-brand {
      display: flex !important;
      align-items: center;
      gap: 14px;
      height: auto !important;
      line-height: normal !important;
    }

    /* ✅ LOGO 真正变大（视觉上） */
    .brand-logo {
      width: 64px !important;
      height: 64px !important;
      object-fit: cover !important;
      transform: scale(1.3);
      transform-origin: center;
      display: block;
    }

    /* ✅ 唯一一层方框 */
    .brand-badge {
      display: inline-flex;
      flex-direction: column;
      padding: 6px 10px;
      border-radius: 10px;
      border: 2px solid rgba(255,255,255,.8);
      line-height: 1.1;
    }

    body:not(.tpl-has-hero) .brand-badge {
      border-color: rgba(9,26,93,.35);
    }

    .brand-main {
      font-size: 20px;
      font-weight: 800;
      white-space: nowrap;
    }

    .brand-sub {
      font-size: 11px;
      opacity: .75;
      letter-spacing: 2px;
      margin-top: 3px;
    }

    /* =========================================================
       字体颜色：首页 vs 子页
    ========================================================= */
    body.tpl-has-hero .navbar a,
    body.tpl-has-hero .navbar span {
      color: #fff !important;
    }

    body:not(.tpl-has-hero) .navbar a,
    body:not(.tpl-has-hero) .navbar span {
      color: #091a5d !important;
    }

    /* =========================================================
       Mobile
    ========================================================= */
    @media (max-width: 768px) {
      body.tpl-body:not(.tpl-has-hero) {
        padding-top: 82px;
      }

      .brand-logo {
        width: 44px !important;
        height: 44px !important;
        transform: scale(1.2);
      }

      .brand-main { font-size: 16px; }
    }
  </style>
</head>

<body class:list={["tpl-body", hasHero ? "tpl-has-hero" : ""]}>
  <!-- NAV -->
  <div class="banner" id="home">
    <nav class="navbar navbar-default">
      <div class="navbar-header navbar-left">
        <button
          type="button"
          class="navbar-toggle collapsed"
          data-toggle="collapse"
          data-target="#nav-collapse"
        >
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="navbar-brand" href="/">
          <img src="/images/logo.png" class="brand-logo" alt="Cendant" />
          <span class="brand-badge">
            <span class="brand-main">墨尔本 · 胜腾国际</span>
            <span class="brand-sub">MELBOURNE · CENDANT</span>
          </span>
        </a>
      </div>

      <div class="collapse navbar-collapse navbar-right" id="nav-collapse">
        <ul class="nav navbar-nav">
          {nav.map((i) => (
            <li class={isActive(i.href) ? "active" : ""}>
              <a href={i.href}><span>{i.label}</span></a>
            </li>
          ))}
        </ul>
      </div>
    </nav>
  </div>

  <!-- PAGE -->
  <main>
    <slot />
  </main>

  <!-- FOOTER -->
  {showFooter && (
    <div class="footer">
      <div class="col-md-6 subscribe">
        <h3>联系我们</h3>
        <a class="btn1" href="/contact">联系咨询</a>
      </div>
      <div class="col-md-6 copyright">
        <p>© {new Date().getFullYear()} Melbourne Cendant</p>
      </div>
      <div class="clearfix"></div>
    </div>
  )}

  <script src="/template15/js/jquery-2.1.4.min.js"></script>
  <script src="/template15/js/bootstrap.js"></script>
</body>
</html>