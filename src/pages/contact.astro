---
import TemplateLayout from "../layouts/TemplateLayout.astro";
import SubpageIntroBanner from "../components/SubpageIntroBanner.astro";
---

<TemplateLayout title="联系我们">
  <SubpageIntroBanner
    titleZh="联系我们"
    titleEn="CONTACT US"
    items={[
      { title: "微信", desc: "Melly0513", fa: "fa fa-wechat" },
      { title: "电话", desc: "+61 420 616 883", fa: "fa fa-phone" },
      { title: "邮箱", desc: "info@cendantproperty.com.au", fa: "fa fa-envelope" },
      { title: "WhatsApp", desc: "+61 420 616 883", fa: "fa fa-whatsapp" },
    ]}
  />
  <!-- 子页面内容：从上到下 -->
  <section class="contact-page">
    <div class="container">
      <!-- 1) 联系信息 -->
      <div class="contact-block">
        <h2 class="cp-title">联系我们</h2>

        <div class="cp-item">
          <div class="cp-label">电话</div>
          <div class="cp-value">+61 420 616 883</div>
        </div>

        <div class="cp-item">
          <div class="cp-label">邮箱</div>
          <div class="cp-value">
            <a href="mailto:info@cendantproperty.com.au">info@cendantproperty.com.au</a>
          </div>
        </div>

        <div class="cp-item">
          <div class="cp-label">地址</div>
          <div class="cp-value">2 Aquitania Way, Docklands VIC 3008</div>
        </div>

        <div class="cp-item">
          <div class="cp-label">微信</div>
          <div class="cp-value">Melly0513</div>
        </div>

        <div class="cp-item">
          <div class="cp-label">WhatsApp</div>
          <div class="cp-value">+61 420 616 883</div>
        </div>

        <div class="cp-quick">
          <a class="cp-link" href="/company-profile">公司概况</a>
          <a class="cp-link" href="/real-estate">房产资讯</a>
          <a class="cp-link" href="/property-service">房产服务</a>
          <a class="cp-link" href="/loan">贷款服务</a>
          <a class="cp-link" href="/immigration">移民服务</a>
        </div>
      </div>

      <!-- 2) 在线留言 -->
      <div class="contact-block">
        <h2 class="cp-title">在线留言</h2>

        <form id="lead-form" class="cp-form">
          <label class="cp-field">
            <span>姓名 *</span>
            <input name="name" type="text" required />
          </label>

          <label class="cp-field">
            <span>邮箱 *</span>
            <input name="email" type="email" required />
          </label>

          <label class="cp-field">
            <span>电话</span>
            <input name="phone" type="text" />
          </label>

          <label class="cp-field">
            <span>留言内容 *</span>
            <textarea name="message" rows="6" required></textarea>
          </label>

          <button class="btn1" type="submit">提交</button>
          <p id="lead-result" class="cp-result"></p>
        </form>
      </div>
    </div>
  </section>

  <script is:inline>
    (function () {
      const form = document.getElementById("lead-form");
      const result = document.getElementById("lead-result");
      if (!form || !result) return;

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        result.textContent = "提交中…";

        const data = Object.fromEntries(new FormData(form));
        data.topic = "联系我们";

        try {
          const res = await fetch("/api/leads", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
          });

          if (res.ok) {
            result.textContent = "我们已收到您的信息，会尽快联系您。";
            form.reset();
          } else {
            result.textContent = "提交失败，请稍后再试。";
          }
        } catch (err) {
          result.textContent = "网络异常，请稍后再试。";
        }
      });
    })();
  </script>
</TemplateLayout>

<style>
  /* 子页面内容：更“页面化”，不做左右分栏 */
  .contact-page {
    padding: 24px 0 60px;
  }

  .contact-block {
    background: #fff;
    border: 1px solid rgba(11, 27, 84, 0.10);
    border-radius: 12px;
    padding: 22px 18px;
    margin-bottom: 18px;
  }

  .cp-title {
    margin: 0 0 14px;
    font-size: 20px;
    font-weight: 900;
    color: #0b1b54;
    letter-spacing: 0.3px;
  }

  .cp-item {
    display: grid;
    grid-template-columns: 90px 1fr;
    gap: 12px;
    padding: 10px 0;
    border-top: 1px solid rgba(11, 27, 84, 0.08);
  }
  .cp-item:first-of-type {
    border-top: 0;
    padding-top: 6px;
  }

  .cp-label {
    color: rgba(11, 27, 84, 0.75);
    font-weight: 700;
  }

  .cp-value {
    color: #0b1b54;
    word-break: break-word;
  }

  .cp-value a {
    color: #0b1b54;
    text-decoration: underline;
  }

  .cp-quick {
    margin-top: 14px;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }

  .cp-link {
    display: inline-block;
    padding: 8px 12px;
    border: 1px solid rgba(11, 27, 84, 0.14);
    border-radius: 999px;
    color: #0b1b54;
    text-decoration: none;
    font-weight: 700;
    font-size: 13px;
  }

  /* 表单 */
  .cp-form {
    display: grid;
    gap: 12px;
  }

  .cp-field span {
    display: block;
    margin-bottom: 6px;
    font-weight: 700;
    color: rgba(11, 27, 84, 0.85);
  }

  .cp-field input,
  .cp-field textarea {
    width: 100%;
    border: 1px solid rgba(11, 27, 84, 0.16);
    border-radius: 10px;
    padding: 10px 12px;
    outline: none;
  }

  .cp-field input:focus,
  .cp-field textarea:focus {
    border-color: rgba(11, 27, 84, 0.35);
  }

  .cp-result {
    margin: 0;
    font-size: 13px;
    color: rgba(11, 27, 84, 0.75);
  }
</style>