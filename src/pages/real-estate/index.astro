---
import TemplateLayout from "../../layouts/TemplateLayout.astro";
import { getRealEstatePosts } from "../../lib/contentful";
import SubpageIntroBanner from "../../components/SubpageIntroBanner.astro";
/**
 * 这里是房产资讯首页
 * 只展示分类入口 + 最新发布
 */
const posts = await getRealEstatePosts(6);
const introItems = [
  { title: "覆盖类别", desc: "售卖/出租/土地开发/商业办公等分类入口。" },
  { title: "选房要点", desc: "整理交易流程、议价策略、回报与风险提示。" },
  { title: "咨询对接", desc: "有意向可直接向我们提交表单，专人对接。" },
];

/**
 * 出售分类
 */
const saleCats = [
  { label: "公寓", href: "/real-estate/sale/apartment" },
  { label: "二手房", href: "/real-estate/sale/second-hand" },
  { label: "联排别墅", href: "/real-estate/sale/townhouse" },
  { label: "土地别墅", href: "/real-estate/sale/land-villa" },
  { label: "商业办公楼", href: "/real-estate/sale/commercial" },
  { label: "土地开发", href: "/real-estate/sale/land" },
  { label: "农场", href: "/real-estate/sale/farm" },
  { label: "酒店", href: "/real-estate/sale/hotel" },
];

/**
 * 出租分类
 */
const rentCats = [
  { label: "公寓", href: "/real-estate/rent/apartment" },
  { label: "联排别墅", href: "/real-estate/rent/townhouse" },
  { label: "土地别墅", href: "/real-estate/rent/land-villa" },
  { label: "商业办公", href: "/real-estate/rent/commercial" },
];
---

<TemplateLayout title="房产资讯" subtitle="REAL ESTATE">
  <SubpageIntroBanner titleZh="房产资讯" titleEn="REAL ESTATE" items={introItems} />
  <!-- ===============================
       分类入口
  ================================ -->
  <section class="service-area section-padding">
    <div class="container">
      <!-- 出售 -->
      <div class="section-title re-title">
        <h2>房产售卖资讯</h2>
      </div>

      <div class="service-grid">
        {saleCats.map((c) => (
          <a class="service-card" href={c.href}>
            <span class="service-dot" aria-hidden="true"></span>
            <h4>{c.label}</h4>
          </a>
        ))}
      </div>

      <!-- 出租 -->
      <div class="section-title re-title mt-40">
        <h2>房产出租资讯</h2>
      </div>

      <div class="service-grid">
        {rentCats.map((c) => (
          <a class="service-card" href={c.href}>
            <span class="service-dot" aria-hidden="true"></span>
            <h4>{c.label}</h4>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- ===============================
       最新发布（来自 Contentful）
  ================================ -->
  <section class="blog-area section-padding gray-bg">
    <div class="container">
      <div class="section-title re-title">
        <h2>最新发布</h2>
      </div>

      {posts && posts.length > 0 ? (
        <div class="blog-grid">
          {posts.map((p) => (
            <a class="blog-card" href={`/real-estate/${p.slug}`}>
              <div class="blog-content">
                <span class="blog-tag">{p.category ?? "资讯"}</span>
                <h4>{p.title}</h4>
                {p.publishDate && (
                  <p class="blog-date">
                    {new Date(p.publishDate).toLocaleDateString("zh-CN")}
                  </p>
                )}
              </div>
            </a>
          ))}
        </div>
      ) : (
        <div class="empty">
          <p><strong>目前还没有文章。</strong></p>
          <p>
            请在 Contentful 中新建 <code>realEstatePost</code> 并发布。
          </p>
        </div>
      )}
    </div>
  </section>
</TemplateLayout>

<style>
/* =========================
   0) 标题：更小更商务（直接覆盖 section-title h2）
   - 不依赖 re-title class
========================= */
.section-title{
  margin: 0 0 16px;
}

.section-title h2{
  font-size: 22px !important;
  line-height: 1.25 !important;
  font-weight: 800 !important;
  letter-spacing: .5px;
  color: #0b1b54 !important;
  margin: 0 !important;
}

/* 点缀短线（更精致） */
.section-title h2::after{
  content:"";
  display:block;
  width:56px;
  height:3px;
  background:#f2a23a;
  border-radius:999px;
  margin-top:10px;
}

/* ========== 让“房产售卖资讯”标题离 TopBanner 更远一点 ========== */
/* 你的分类入口区块：第一个 section */
.service-area.section-padding{
  padding-top: 64px !important;   /* 原来可能很小/被覆盖 */
  padding-bottom: 0px !important;
}

/* ========== 让“最新发布”整个区块与上一块拉开 ========== */
/* 你的最新发布区块：第二个 section 最新发布*/
.blog-area.section-padding{
  padding-top: 0px !important;   /* 关键：拉开“最新发布”上方距离 */
  padding-bottom: 64px !important;
}

/* 如果 gray-bg 有把 padding 压扁，这里兜底 */
.blog-area.section-padding.gray-bg{
  padding-top: 64px !important;
}

/* ========== 每个标题本身：统一上下间距 ========== */
.section-title{
  margin-top: 0 !important;
  margin-bottom: 22px !important; /* 标题与下面卡片的距离更舒服 */
}

/* 第二段标题（你用了 mt-40）：更明显的分隔 */
.section-title.mt-40{
  margin-top: 64px !important;
}

/* ========== 手机端再稍微紧凑一点 ========== */
@media (max-width: 768px){
  .service-area.section-padding{
    padding-top: 42px !important;
    padding-bottom: 42px !important;
  }
  .blog-area.section-padding{
    padding-top: 46px !important;
    padding-bottom: 52px !important;
  }
  .section-title{
    margin-bottom: 18px !important;
  }
  .section-title.mt-40{
    margin-top: 46px !important;
  }
}

/* =========================
   1) Service 分类卡片
========================= */
.service-grid{
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap:18px;
}

.service-card{
  display:block;
  padding:18px;
  border:1px solid rgba(11, 27, 84, 0.10);
  border-radius:12px;
  background:#fff;
  transition:all .25s ease;
  text-decoration:none;
}

.service-card:hover{
  transform:translateY(-3px);
  box-shadow:0 10px 26px rgba(0,0,0,.08);
  border-color: rgba(11, 27, 84, 0.18);
}

.service-card h4{
  margin:0;
  font-size:15px;
  font-weight:700;
  color:#0b1b54;
}

.service-dot{
  display:inline-block;
  width:8px;
  height:8px;
  background:#0b1b54;
  border-radius:50%;
  margin-bottom:12px;
}

/* =========================
   2) Blog 列表
========================= */
.blog-grid{
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap:22px;
}

.blog-card{
  display:block;
  padding:20px;
  background:#fff;
  border-radius:12px;
  border:1px solid rgba(0,0,0,.06);
  text-decoration:none;
  transition:all .25s ease;
}

.blog-card:hover{
  transform:translateY(-3px);
  box-shadow:0 10px 26px rgba(0,0,0,.08);
}

.blog-tag{
  font-size:12px;
  color:#5b6474;
  display:inline-block;
  margin-bottom:8px;
}

.blog-card h4{
  margin:0;
  font-size:16px;
  font-weight:800;
  line-height:1.35;
  color:#0b1b54;
}

.blog-date{
  font-size:12px;
  color:#8a93a3;
  margin-top:8px;
}

.empty{
  padding:34px;
  text-align:center;
  background:#fff;
  border-radius:12px;
  border:1px dashed rgba(11, 27, 84, 0.25);
}

/* 兜底：如果你页面里还在用 mt-40 */
.mt-40{ margin-top:40px; }
</style>